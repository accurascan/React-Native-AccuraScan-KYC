package com.accurascankyc;

import android.graphics.Typeface;
import android.os.AsyncTask;
import android.widget.TextView;

import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.net.HttpURLConnection;
import java.net.URL;

public class DownloadFontTask extends AsyncTask<String, Void, File> {

  private TextView textView;

  public DownloadFontTask(TextView textView) {
    this.textView = textView;
  }

  @Override
  protected File doInBackground(String... urls) {
    String urlString = urls[0];
    File fontFile = null;
    try {
      URL url = new URL(urlString);
      HttpURLConnection connection = (HttpURLConnection) url.openConnection();
      connection.setRequestMethod("GET");
      connection.connect();

      InputStream inputStream = connection.getInputStream();
      fontFile = new File(textView.getContext().getCacheDir(), "custom_font.ttf");

      FileOutputStream outputStream = new FileOutputStream(fontFile);
      byte[] buffer = new byte[1024];
      int length;
      while ((length = inputStream.read(buffer)) > 0) {
        outputStream.write(buffer, 0, length);
      }
      outputStream.close();
      inputStream.close();
    } catch (Exception e) {
      e.printStackTrace();
    }
    return fontFile;
  }

  @Override
  protected void onPostExecute(File fontFile) {
    if (fontFile != null && textView != null) {
      Typeface typeface = Typeface.createFromFile(fontFile);
      textView.setTypeface(typeface);
    }
  }
}

